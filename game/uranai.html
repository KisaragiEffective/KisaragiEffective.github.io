<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>なんちゃって占いコーナー</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script type="text/javascript">
window.addEventListener("load", (e) => {
  const seiza = ["おひつじ", "おうし", "ふたご", "かに", "しし", "おとめ", "てんびん", "さそり", "いて", "やぎ", "みずがめ", "うお"];
  const items = ["テレビ", "洗濯機", "観葉植物", "ハンカチ", "スカーフ", "金魚", "ネックレス", "イヤリング", "椅子", "タイマー", "バーベキュー用品", "リュックサック", "吊り革", "時計", "せっけん", "電話", "おにぎり", "ワイシャツ", "コート", "自転車", "ペンケース", "パソコン", "机", "ベンチ", "掃除用品", "座布団"];
  const star5 = ["思い通りにすごせる", "%形容詞%になりそう", "%名詞%をもらえそう", "願いがかなう"];
  const star4 = ["レベルアップの日", "%形容動詞%に過ごせる", "発想豊かな1日", "面白い発想が浮かぶ", "心温まる日", "%名詞%は身近なところに"];
  const star3 = ["自分を信じて大丈夫", "ひとつのことに集中して", "人を疑わないで", "やる気を出して！", "誰かに相談して", "難関突破でハッピーに"]
  const star2 = ["苦手な人に遭遇", "予想が外れる", "頼られすぎる", "%形容詞%になりがち"];
  const star1 = ["勘違いが多い", "信頼関係にひびが入る", "悪役キャラになりそう", "心配な出来事あり"];
  const advise = ["%食べ物%を食べる", "外出する", "持ち物をきれいにする", "壁をノックする", "ピクニックに行く"];
  /*
  * fetch quarry
  */
  function quarry(dumpId, index = 0) {
    let ret;
    while (true) {
      $.get(`https://quarry.wmflabs.org/run/${dumpId}/output/${index}/json`, (it) => {ret = it})
       .done(() => { break });
    }
    return ret;
  };
  
  const vegitables = quarry(484012);
  console.log(vegitables);
  
  const colors = ["赤", "緑", "黄色", "紫", "青", "白", "灰色", "水色", "ベージュ", "オレンジ", "ブラウン"];
  const desc = [null, star1, star2, star3, star4, star5];

  const stars = function(rank) {
    if (rank <= 2) {
      return 5;
    } else if (rank <= 5) {
      return 4;
    } else if (rank <= 8) {
      return 3;
    } else if (rank <= 10) {
      return 2;
    } else if (rank <= 12) {
      return 1;
    }
  }

  const shuffle = function(array) {
    for(let i = array.length - 1; i > 0; i--){
      let r = Math.floor(Math.random() * (i + 1));
      let tmp = array[i];
      array[i] = array[r];
      array[r] = tmp;
    }
  }
  
  // array-ize and clone
  const tpc = [].concat(seiza);
  shuffle(tpc);
  tpc.forEach(function(str, index) {
    const pqq = stars(index + 1);
    const tfr = "☆".repeat(pqq) + "★".repeat(5 - pqq);
    const qrt = desc[pqq];
    const ymt = qrt[Math.floor(Math.random()*qrt.length)];
    console.log(`${index + 1}位: ${str}座    ${tfr}\n${ymt}`);
  });
});
  


</script>
</head>
<body>
  <div id="github"></div>
  <noscript>JavaScriptを有効にしてください。</noscript>
  <div class="main">
  </div>
  <p> これは文章です。なんちゃらかんちゃら </p>
  <script>

  </script>
</body>
<foot>
<a href="index.html">RETURN TO GAME CENTER</a>
</foot>
</html>
